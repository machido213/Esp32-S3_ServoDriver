# ğŸ¤– ESP32-S3 7-Axis Servo Driver & Industrial Controller

é€™æ˜¯ä¸€å€‹åŸºæ–¼ **ESP32-S3 (N16R8)** çš„å¤šè»¸ä¼ºæœé¦¬é”é©…å‹•èˆ‡å·¥æ§ç³»çµ±ã€‚å°ˆç‚º ROS æ©Ÿå™¨äººä¸‹ä½æ©Ÿè¨­è¨ˆï¼Œå…·å‚™ 7 è»¸è„ˆæ³¢æ§åˆ¶ã€å·¥æ§ç®±å¯¦é«”æŒ‰éˆ•æ•´åˆã€å®‰å…¨äº’é–é‚è¼¯ï¼Œä»¥åŠæ”¯æ´ **WiFi æ–·ç·šæ•‘æ´ (AP Mode)** èˆ‡ **åƒæ•¸è¨˜æ†¶ (NVS)** çš„æš—é»‘é¢¨æ ¼ Web æ§åˆ¶å„€è¡¨æ¿ã€‚

## âœ¨ å°ˆæ¡ˆç‰¹é» (Features)

*   **æ ¸å¿ƒæ§åˆ¶**: æ”¯æ´ 7 è»¸æ­¥é€²/ä¼ºæœé¦¬é”æ§åˆ¶ (Pulse/Direction æ¨¡å¼)ã€‚
*   **Web å„€è¡¨æ¿**: å…§å»ºæš—é»‘å·¥æ¥­é¢¨ Web Server (SPIFFS è¨—ç®¡)ï¼Œæ”¯æ´ RWD éŸ¿æ‡‰å¼è¨­è¨ˆã€‚
    *   **å³æ™‚ç›£æ§**: IO ç‹€æ…‹ (åœæ­¢æŒ‰éˆ•ã€æ¥è§¸å™¨å›é¥‹)ã€ç’°å¢ƒæº«åº¦ã€‚
    *   **é¦¬é”æ§åˆ¶**: æ”¯æ´å–®æ¬¡å®šä½æ§åˆ¶ (Steps/Hz) èˆ‡ **é•·æŒ‰é»å‹• (Jog) æ§åˆ¶** (æ­£/åè½‰)ã€‚
    *   **ç³»çµ±æ§åˆ¶**: é ç«¯å•Ÿå‹•ã€å¼·åˆ¶æ–·é›»ã€ä¼ºæœå§‹èƒ½åˆ‡æ›ã€‚
*   **æ™ºæ…§ç¶²è·¯ç®¡ç†**:
    *   **NVS è¨˜æ†¶**: è‡ªå‹•å„²å­˜ WiFi SSIDã€å¯†ç¢¼èˆ‡å›ºå®š IP è¨­å®šï¼Œæ–·é›»ä¸éºå¤±ã€‚
    *   **æ–·ç·šæ•‘æ´ (AP Mode)**: è‹¥é€£ç·šå¤±æ•— (å¦‚å¯†ç¢¼éŒ¯èª¤æˆ–è·¯ç”±å™¨æ–·é›»)ï¼Œè‡ªå‹•åˆ‡æ›è‡³ç†±é»æ¨¡å¼ (`ESP32-Rescue-Mode`)ï¼Œå…è¨±ä½¿ç”¨è€…é€£å…¥é‡æ–°è¨­å®šã€‚
*   **å®‰å…¨é‚è¼¯**:
    *   **è‡ªå‹•å§‹èƒ½**: ç•¶åµæ¸¬åˆ°æ¥è§¸å™¨å¸åˆä¸”ç„¡åœæ­¢è¨Šè™Ÿæ™‚ï¼Œè‡ªå‹•é–‹å•Ÿ Servo ONã€‚
    *   **è»Ÿåœæ­¢ä¿è­·**: æŒ‰ä¸‹åœæ­¢éˆ•æ™‚ï¼Œè‡ªå‹•åˆ‡æ–·å§‹èƒ½ä¸¦è§¸ç™¼æ–·é›»ç¹¼é›»å™¨ã€‚
*   **OTA æ›´æ–°**: æ”¯æ´é€é Web ä»‹é¢å¾ GitHub æˆ– Local Server é€²è¡Œç„¡ç·šéŸŒé«”æ›´æ–°ã€‚

## ğŸ›  ç¡¬é«”è¦æ ¼ (Hardware)

*   **MCU**: ESP32-S3-WROOM-1U (N16R8)
    *   **Flash**: 16MB
    *   **PSRAM**: 8MB (Octal Mode)
    *   *æ³¨æ„ï¼šç”±æ–¼ä½¿ç”¨ Octal PSRAMï¼ŒGPIO 33~37 è¢«å…§éƒ¨ä½”ç”¨ä¸å¯ä½¿ç”¨ã€‚*
*   **é›»æº**: å»ºè­°å¤–éƒ¨ä¾›é›» 5V/3.3V (é‚è¼¯)ï¼Œé¦¬é”é©…å‹•å™¨ä¾è¦æ ¼ä¾›é›» (24V/48V)ã€‚
*   **é€£æ¥ä»‹é¢**: USB Type-C (Native USB D+/D-)ã€‚

---

## ğŸ”Œ è…³ä½å®šç¾©èˆ‡æ¥ç·šè¡¨ (Pin Map)

ä¸‹è¡¨ä¾ç…§æ‚¨çš„å·¥æ§ç®±è¨­è¨ˆé‚è¼¯æ•´ç†ï¼ŒåŒ…å«äº† 7 è»¸é¦¬é”ã€æ„Ÿæ¸¬å™¨èˆ‡ç¹¼é›»å™¨æ§åˆ¶ã€‚

| ä¸»é …ç›® | å…ƒä»¶ | åŠŸèƒ½æè¿° | è¼¸å…¥/è¼¸å‡º | æ•¸é‡ | GPIO | VCC | GND | å‚™è¨» |
| :--- | :--- | :--- | :---: | :---: | :---: | :---: | :---: | :--- |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 1** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **4, 5** | - | V | 4=Pulse, 5=Dir |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 2** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **6, 7** | - | V | 6=Pulse, 7=Dir |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 3** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **8, 9** | - | V | 8=Pulse, 9=Dir |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 4** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **10, 11** | - | V | 10=Pulse, 11=Dir |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 5** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **12, 13** | - | V | 12=Pulse, 13=Dir |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 6** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **14, 15** | - | V | 14=Pulse, 15=Dir |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 7** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **16, 17** | - | V | 16=Pulse, 17=Dir |
| **é¦¬é”å…±ç”¨** | ä¼ºæœé©…å‹•å™¨ | **Servo Enable** (å§‹èƒ½) | è¼¸å‡º | 1 | **42** | - | V | æ¥è‡³æ‰€æœ‰é©…å‹•å™¨ SON |
| **ç³»çµ±æ§åˆ¶** | ç¹¼é›»å™¨æ¨¡çµ„ | **é ç«¯å•Ÿå‹•è§¸ç™¼** | è¼¸å‡º | 1 | **38** | 5V | V | **ä¸¦è¯**æ–¼å¯¦é«”å•Ÿå‹•éˆ• (å¸¸é–‹ NO) |
| **ç³»çµ±æ§åˆ¶** | ç¹¼é›»å™¨æ¨¡çµ„ | **å¼·åˆ¶æ–·é›»è§¸ç™¼** | è¼¸å‡º | 1 | **39** | 5V | V | **ä¸²è¯**æ–¼æ¥è§¸å™¨ç·šåœˆ (å¸¸é–‰ NC) |
| **ç³»çµ±è¼¸å…¥** | å¯¦é«”æŒ‰éˆ• | **åœæ­¢æŒ‰éˆ•åµæ¸¬** | è¼¸å…¥ | 1 | **40** | - | V | å»ºè­°ä½¿ç”¨ NC æ¥é» (è»Ÿé«”ä¸Šæ‹‰) |
| **ç³»çµ±è¼¸å…¥** | å…‰è€¦æ¨¡çµ„ | **æ¥è§¸å™¨ç‹€æ…‹å›é¥‹** | è¼¸å…¥ | 1 | **41** | 3.3V | V | **å¿…é ˆéš”é›¢**ï¼Œåµæ¸¬æ¥è§¸å™¨æ˜¯å¦å¸åˆ |
| **ç’°å¢ƒç›£æ§** | DS18B20 | **æ©Ÿç®±æº«åº¦åµæ¸¬** | è¼¸å…¥ | 1 | **18** | 3.3V | V | éœ€æ¥ 4.7k ä¸Šæ‹‰é›»é˜» |
| **ç’°å¢ƒç›£æ§** | MOSFETæ¨¡çµ„ | **æ•£ç†±é¢¨æ‰‡æ§åˆ¶** | è¼¸å‡º | 1 | **21** | 24V | V | PWM æ§åˆ¶é¢¨æ‰‡è½‰é€Ÿ |
| **é€šè¨Š/é™¤éŒ¯** | USB | **USB Serial/JTAG** | I/O | 2 | **19, 20** | - | - | 19=D-, 20=D+ (ç›´é€£ Jetson) |
| **é€šè¨Š/é™¤éŒ¯** | æŒ‰éˆ• | **Alive Check** | è¼¸å…¥ | 1 | **0** | - | V | æ¿è¼‰ BOOT éµï¼Œç”¨æ–¼ Log æ¸¬è©¦ |

---

## âš¡ æ¥ç·šé‚è¼¯èªªæ˜ (Wiring Logic)

ç‚ºäº†ç¢ºä¿å®‰å…¨æ€§èˆ‡é ç«¯æ§åˆ¶çš„éˆæ´»æ€§ï¼Œè«‹éµå¾ªä»¥ä¸‹æ¥ç·šé‚è¼¯ï¼š

### 1. å•Ÿå‹•è¿´è·¯ (Start Loop)
*   **ç›®æ¨™**ï¼šé€é Web é ç«¯å•Ÿå‹•ï¼Œæˆ–ç¾å ´æŒ‰ä¸‹ç¶ è‰²æŒ‰éˆ•å•Ÿå‹•ã€‚
*   **æ¥æ³•**ï¼šESP32 æ§åˆ¶çš„ç¹¼é›»å™¨ (GPIO 38) çš„ **NO (å¸¸é–‹) æ¥é»**ï¼Œéœ€ **ä¸¦è¯ (Parallel)** æ¥åœ¨å¯¦é«”å•Ÿå‹•æŒ‰éˆ•çš„å…©ç«¯ã€‚
*   **å‹•ä½œ**ï¼šESP32 é€å‡ºè¨Šè™Ÿ -> ç¹¼é›»å™¨å¸åˆ 0.5 ç§’ -> æ¨¡æ“¬äººæ‰‹æŒ‰ä¸‹ -> æ¥è§¸å™¨è‡ªé–é€šé›»ã€‚

### 2. åœæ­¢/æ–·é›»è¿´è·¯ (Stop/Cutoff Loop)
*   **ç›®æ¨™**ï¼šè»Ÿé«”åµæ¸¬åˆ°ç•°å¸¸æˆ–æŒ‰ä¸‹ Web æ–·é›»éˆ•æ™‚ï¼Œå¼·åˆ¶åˆ‡æ–·å¼·é›»ã€‚
*   **æ¥æ³•**ï¼šESP32 æ§åˆ¶çš„ç¹¼é›»å™¨ (GPIO 39) çš„ **NC (å¸¸é–‰) æ¥é»**ï¼Œéœ€ **ä¸²è¯ (Series)** åœ¨æ¥è§¸å™¨çš„ç·šåœˆä¾›é›»è¿´è·¯ä¸Šã€‚
*   **å‹•ä½œ**ï¼šESP32 é€å‡ºè¨Šè™Ÿ -> ç¹¼é›»å™¨æ–·é–‹ -> æ¥è§¸å™¨ç·šåœˆå¤±é›» -> ç³»çµ±è·³è„«ã€‚

### 3. ç‹€æ…‹å›é¥‹ (Feedback)
*   **é‡è¦**ï¼šå› ç‚º ESP32 æ˜¯ 3.3V é‚è¼¯ï¼Œ**çµ•å°ä¸å¯**ç›´æ¥å°‡æ¥è§¸å™¨çš„ 24V/110V è¼”åŠ©æ¥é»æ¥åˆ° GPIOã€‚
*   **æ¥æ³•**ï¼šä½¿ç”¨ **å…‰è€¦åˆéš”é›¢æ¨¡çµ„ (Optocoupler)** æˆ– **24Vè½‰3.3V æ¨¡çµ„**ã€‚

---

## ğŸŒ ç¶²è·¯é…ç½®èˆ‡æ•‘æ´æ¨¡å¼ (Network & Rescue)

æœ¬ç³»çµ±å…·å‚™æ™ºæ…§é…ç¶²åŠŸèƒ½ï¼Œç„¡éœ€æ¯æ¬¡ä¿®æ”¹ç¨‹å¼ç¢¼ã€‚

### 1. æ­£å¸¸å•Ÿå‹•
*   ç³»çµ±æœƒè®€å–å…§éƒ¨è¨˜æ†¶é«” (NVS) çš„ WiFi è¨­å®šã€‚
*   é è¨­å‡ºå» è¨­å®šç‚ºï¼š
    *   SSID: `SSID`
    *   å¯†ç¢¼: `************`
    *   Static IP: `192.168.2.124`

### 2. æ•‘æ´æ¨¡å¼ (AP Mode)
è‹¥ ESP32 é€£æ¥ WiFi å¤±æ•— (è¶…é 5 æ¬¡é‡è©¦)ï¼Œå°‡è‡ªå‹•åˆ‡æ›ç‚º **ç†±é»æ¨¡å¼**ï¼š
1.  **æœå°‹ WiFi**: `ESP32-Rescue-Mode`
2.  **é€£æ¥å¯†ç¢¼**: ç„¡ (æˆ–è‡ªè¨‚)
3.  **ç€è¦½å™¨è¨ªå•**: `http://192.168.4.1`
4.  åœ¨å„€è¡¨æ¿çš„ã€Œç¶²è·¯è¨­å®šã€å€å¡Šè¼¸å…¥æ­£ç¢ºçš„ WiFi è³‡è¨Šï¼Œé»æ“Šã€Œå„²å­˜ä¸¦é‡å•Ÿã€å³å¯ã€‚

---

## ğŸ–¥ï¸ Web å„€è¡¨æ¿ (Dashboard)

ç³»çµ±å•Ÿå‹•å¾Œï¼Œè«‹è¨ªå•è¨­å®šçš„ IP (é è¨­ `http://192.168.2.124`)ã€‚

### åŠŸèƒ½å€å¡Š
1.  **Monitor (å·¦å´)**: ç›£æ§åœæ­¢æŒ‰éˆ•ã€æ¥è§¸å™¨ç‹€æ…‹ã€æ©Ÿç®±æº«åº¦ã€‚
2.  **Network Config (ä¸­é–“)**: ä¿®æ”¹ WiFi SSIDã€å¯†ç¢¼èˆ‡å›ºå®š IP (ä¿®æ”¹å¾Œè‡ªå‹•é‡å•Ÿ)ã€‚
3.  **Control (ä¸­é–“)**: é ç«¯åŸ·è¡Œå•Ÿå‹•ã€æ–·é›»ã€ä¼ºæœå§‹èƒ½åˆ‡æ›ã€‚
4.  **OTA (å³å´)**: å¡«å…¥ `.bin` é€£çµé€²è¡Œç„¡ç·šæ›´æ–°ã€‚
5.  **Motors (ä¸‹æ–¹)**: 7 è»¸é¦¬é”æ§åˆ¶ï¼Œå…·å‚™ **RUN (å–®æ¬¡åŸ·è¡Œ)** èˆ‡ **Jog (é»å‹•é•·æŒ‰)** æŒ‰éˆ•ã€‚

---

## ğŸš€ é–‹ç™¼èˆ‡ç‡’éŒ„ (Development)

æœ¬å°ˆæ¡ˆä½¿ç”¨ ESP-IDF v5.4 é–‹ç™¼ï¼Œä¸¦æ¡ç”¨ SPIFFS å­˜æ”¾ç¶²é æª”æ¡ˆã€‚

**å°ˆæ¡ˆçµæ§‹è¦æ±‚:**
å¿…é ˆåœ¨æ ¹ç›®éŒ„å»ºç«‹ `spiffs_image` è³‡æ–™å¤¾ï¼Œä¸¦å°‡ `index.html` æ”¾å…¥å…¶ä¸­ã€‚

Esp32-S3_ServoDriver/
â”œâ”€â”€ CMakeLists.txt (Root, éœ€åŒ…å« spiffs_create_partition_image)
â”œâ”€â”€ partitions.csv (éœ€å®šç¾© storage åˆ†å€)
â”œâ”€â”€ spiffs_image/
â”‚ â””â”€â”€ index.html
â””â”€â”€ main/
â”œâ”€â”€ main.c
â””â”€â”€ CMakeLists.txt (Main, ç§»é™¤ index.html å¼•ç”¨)
**ç·¨è­¯ç’°å¢ƒè¨­å®š:**
```bash
idf.py set-target esp32s3
idf.py menuconfig
# 1. Serial Flasher -> Flash size: 16MB
# 2. Component config -> ESP32S3-Specific -> PSRAM: Octal Mode
# 3. Partition Table -> Custom partition table CSV file -> partitions.csv
```
ç·¨è­¯èˆ‡ç‡’éŒ„:
ç”±æ–¼ä½¿ç”¨äº† SPIFFS æ‰“åŒ…ï¼Œè«‹ç¢ºä¿ CMake å·²æ­£ç¢ºé…ç½® spiffs_create_partition_imageã€‚
# æ¸…é™¤èˆŠçš„ç·¨è­¯æª” (å»ºè­°)
idf.py fullclean

# ç·¨è­¯ã€ç‡’éŒ„ (åŒ…å«ç¨‹å¼ç¢¼èˆ‡ç¶²é æª”)ã€é–‹å•Ÿç›£æ§
idf.py build flash monitor

æ²’å•é¡Œï¼Œæˆ‘å°‡æ•´ä»½ README.md çš„åŸå§‹ç¢¼æ”¾åœ¨åŒä¸€å€‹ç¨‹å¼ç¢¼å€å¡Šä¸­ï¼Œä½ ç›´æ¥é»æ“Šå³ä¸Šè§’çš„ã€Œè¤‡è£½ã€æŒ‰éˆ•ï¼Œç„¶å¾Œè²¼åˆ°ä½ çš„ README.md æª”æ¡ˆè£¡å³å¯ã€‚
code
Markdown
# ğŸ¤– ESP32-S3 7-Axis Servo Driver & Industrial Controller

é€™æ˜¯ä¸€å€‹åŸºæ–¼ **ESP32-S3 (N16R8)** çš„å¤šè»¸ä¼ºæœé¦¬é”é©…å‹•èˆ‡å·¥æ§ç³»çµ±ã€‚å°ˆç‚º ROS æ©Ÿå™¨äººä¸‹ä½æ©Ÿè¨­è¨ˆï¼Œå…·å‚™ 7 è»¸è„ˆæ³¢æ§åˆ¶ã€å·¥æ§ç®±å¯¦é«”æŒ‰éˆ•æ•´åˆã€å®‰å…¨äº’é–é‚è¼¯ï¼Œä»¥åŠæ”¯æ´ **WiFi æ–·ç·šæ•‘æ´ (AP Mode)** èˆ‡ **åƒæ•¸è¨˜æ†¶ (NVS)** çš„æš—é»‘é¢¨æ ¼ Web æ§åˆ¶å„€è¡¨æ¿ã€‚

## âœ¨ å°ˆæ¡ˆç‰¹é» (Features)

*   **æ ¸å¿ƒæ§åˆ¶**: æ”¯æ´ 7 è»¸æ­¥é€²/ä¼ºæœé¦¬é”æ§åˆ¶ (Pulse/Direction æ¨¡å¼)ã€‚
*   **Web å„€è¡¨æ¿**: å…§å»ºæš—é»‘å·¥æ¥­é¢¨ Web Server (SPIFFS è¨—ç®¡)ï¼Œæ”¯æ´ RWD éŸ¿æ‡‰å¼è¨­è¨ˆã€‚
    *   **å³æ™‚ç›£æ§**: IO ç‹€æ…‹ (åœæ­¢æŒ‰éˆ•ã€æ¥è§¸å™¨å›é¥‹)ã€ç’°å¢ƒæº«åº¦ã€‚
    *   **é¦¬é”æ§åˆ¶**: æ”¯æ´å–®æ¬¡å®šä½æ§åˆ¶ (Steps/Hz) èˆ‡ **é•·æŒ‰é»å‹• (Jog) æ§åˆ¶** (æ­£/åè½‰)ã€‚
    *   **ç³»çµ±æ§åˆ¶**: é ç«¯å•Ÿå‹•ã€å¼·åˆ¶æ–·é›»ã€ä¼ºæœå§‹èƒ½åˆ‡æ›ã€‚
*   **æ™ºæ…§ç¶²è·¯ç®¡ç†**:
    *   **NVS è¨˜æ†¶**: è‡ªå‹•å„²å­˜ WiFi SSIDã€å¯†ç¢¼èˆ‡å›ºå®š IP è¨­å®šï¼Œæ–·é›»ä¸éºå¤±ã€‚
    *   **æ–·ç·šæ•‘æ´ (AP Mode)**: è‹¥é€£ç·šå¤±æ•— (å¦‚å¯†ç¢¼éŒ¯èª¤æˆ–è·¯ç”±å™¨æ–·é›»)ï¼Œè‡ªå‹•åˆ‡æ›è‡³ç†±é»æ¨¡å¼ (`ESP32-Rescue-Mode`)ï¼Œå…è¨±ä½¿ç”¨è€…é€£å…¥é‡æ–°è¨­å®šã€‚
*   **å®‰å…¨é‚è¼¯**:
    *   **è‡ªå‹•å§‹èƒ½**: ç•¶åµæ¸¬åˆ°æ¥è§¸å™¨å¸åˆä¸”ç„¡åœæ­¢è¨Šè™Ÿæ™‚ï¼Œè‡ªå‹•é–‹å•Ÿ Servo ONã€‚
    *   **è»Ÿåœæ­¢ä¿è­·**: æŒ‰ä¸‹åœæ­¢éˆ•æ™‚ï¼Œè‡ªå‹•åˆ‡æ–·å§‹èƒ½ä¸¦è§¸ç™¼æ–·é›»ç¹¼é›»å™¨ã€‚
*   **OTA æ›´æ–°**: æ”¯æ´é€é Web ä»‹é¢å¾ GitHub æˆ– Local Server é€²è¡Œç„¡ç·šéŸŒé«”æ›´æ–°ã€‚

## ğŸ›  ç¡¬é«”è¦æ ¼ (Hardware)

*   **MCU**: ESP32-S3-WROOM-1U (N16R8)
    *   **Flash**: 16MB
    *   **PSRAM**: 8MB (Octal Mode)
    *   *æ³¨æ„ï¼šç”±æ–¼ä½¿ç”¨ Octal PSRAMï¼ŒGPIO 33~37 è¢«å…§éƒ¨ä½”ç”¨ä¸å¯ä½¿ç”¨ã€‚*
*   **é›»æº**: å»ºè­°å¤–éƒ¨ä¾›é›» 5V/3.3V (é‚è¼¯)ï¼Œé¦¬é”é©…å‹•å™¨ä¾è¦æ ¼ä¾›é›» (24V/48V)ã€‚
*   **é€£æ¥ä»‹é¢**: USB Type-C (Native USB D+/D-)ã€‚

---

## ğŸ”Œ è…³ä½å®šç¾©èˆ‡æ¥ç·šè¡¨ (Pin Map)

ä¸‹è¡¨ä¾ç…§æ‚¨çš„å·¥æ§ç®±è¨­è¨ˆé‚è¼¯æ•´ç†ï¼ŒåŒ…å«äº† 7 è»¸é¦¬é”ã€æ„Ÿæ¸¬å™¨èˆ‡ç¹¼é›»å™¨æ§åˆ¶ã€‚

| ä¸»é …ç›® | å…ƒä»¶ | åŠŸèƒ½æè¿° | è¼¸å…¥/è¼¸å‡º | æ•¸é‡ | GPIO | VCC | GND | å‚™è¨» |
| :--- | :--- | :--- | :---: | :---: | :---: | :---: | :---: | :--- |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 1** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **4, 5** | - | V | 4=Pulse, 5=Dir |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 2** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **6, 7** | - | V | 6=Pulse, 7=Dir |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 3** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **8, 9** | - | V | 8=Pulse, 9=Dir |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 4** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **10, 11** | - | V | 10=Pulse, 11=Dir |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 5** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **12, 13** | - | V | 12=Pulse, 13=Dir |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 6** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **14, 15** | - | V | 14=Pulse, 15=Dir |
| **é¦¬é”è»¸** | ä¼ºæœé©…å‹•å™¨ | **Axis 7** (è„ˆæ³¢/æ–¹å‘) | è¼¸å‡º | 2 | **16, 17** | - | V | 16=Pulse, 17=Dir |
| **é¦¬é”å…±ç”¨** | ä¼ºæœé©…å‹•å™¨ | **Servo Enable** (å§‹èƒ½) | è¼¸å‡º | 1 | **42** | - | V | æ¥è‡³æ‰€æœ‰é©…å‹•å™¨ SON |
| **ç³»çµ±æ§åˆ¶** | ç¹¼é›»å™¨æ¨¡çµ„ | **é ç«¯å•Ÿå‹•è§¸ç™¼** | è¼¸å‡º | 1 | **38** | 5V | V | **ä¸¦è¯**æ–¼å¯¦é«”å•Ÿå‹•éˆ• (å¸¸é–‹ NO) |
| **ç³»çµ±æ§åˆ¶** | ç¹¼é›»å™¨æ¨¡çµ„ | **å¼·åˆ¶æ–·é›»è§¸ç™¼** | è¼¸å‡º | 1 | **39** | 5V | V | **ä¸²è¯**æ–¼æ¥è§¸å™¨ç·šåœˆ (å¸¸é–‰ NC) |
| **ç³»çµ±è¼¸å…¥** | å¯¦é«”æŒ‰éˆ• | **åœæ­¢æŒ‰éˆ•åµæ¸¬** | è¼¸å…¥ | 1 | **40** | - | V | å»ºè­°ä½¿ç”¨ NC æ¥é» (è»Ÿé«”ä¸Šæ‹‰) |
| **ç³»çµ±è¼¸å…¥** | å…‰è€¦æ¨¡çµ„ | **æ¥è§¸å™¨ç‹€æ…‹å›é¥‹** | è¼¸å…¥ | 1 | **41** | 3.3V | V | **å¿…é ˆéš”é›¢**ï¼Œåµæ¸¬æ¥è§¸å™¨æ˜¯å¦å¸åˆ |
| **ç’°å¢ƒç›£æ§** | DS18B20 | **æ©Ÿç®±æº«åº¦åµæ¸¬** | è¼¸å…¥ | 1 | **18** | 3.3V | V | éœ€æ¥ 4.7k ä¸Šæ‹‰é›»é˜» |
| **ç’°å¢ƒç›£æ§** | MOSFETæ¨¡çµ„ | **æ•£ç†±é¢¨æ‰‡æ§åˆ¶** | è¼¸å‡º | 1 | **21** | 24V | V | PWM æ§åˆ¶é¢¨æ‰‡è½‰é€Ÿ |
| **é€šè¨Š/é™¤éŒ¯** | USB | **USB Serial/JTAG** | I/O | 2 | **19, 20** | - | - | 19=D-, 20=D+ (ç›´é€£ Jetson) |
| **é€šè¨Š/é™¤éŒ¯** | æŒ‰éˆ• | **Alive Check** | è¼¸å…¥ | 1 | **0** | - | V | æ¿è¼‰ BOOT éµï¼Œç”¨æ–¼ Log æ¸¬è©¦ |

---

## âš¡ æ¥ç·šé‚è¼¯èªªæ˜ (Wiring Logic)

ç‚ºäº†ç¢ºä¿å®‰å…¨æ€§èˆ‡é ç«¯æ§åˆ¶çš„éˆæ´»æ€§ï¼Œè«‹éµå¾ªä»¥ä¸‹æ¥ç·šé‚è¼¯ï¼š

### 1. å•Ÿå‹•è¿´è·¯ (Start Loop)
*   **ç›®æ¨™**ï¼šé€é Web é ç«¯å•Ÿå‹•ï¼Œæˆ–ç¾å ´æŒ‰ä¸‹ç¶ è‰²æŒ‰éˆ•å•Ÿå‹•ã€‚
*   **æ¥æ³•**ï¼šESP32 æ§åˆ¶çš„ç¹¼é›»å™¨ (GPIO 38) çš„ **NO (å¸¸é–‹) æ¥é»**ï¼Œéœ€ **ä¸¦è¯ (Parallel)** æ¥åœ¨å¯¦é«”å•Ÿå‹•æŒ‰éˆ•çš„å…©ç«¯ã€‚
*   **å‹•ä½œ**ï¼šESP32 é€å‡ºè¨Šè™Ÿ -> ç¹¼é›»å™¨å¸åˆ 0.5 ç§’ -> æ¨¡æ“¬äººæ‰‹æŒ‰ä¸‹ -> æ¥è§¸å™¨è‡ªé–é€šé›»ã€‚

### 2. åœæ­¢/æ–·é›»è¿´è·¯ (Stop/Cutoff Loop)
*   **ç›®æ¨™**ï¼šè»Ÿé«”åµæ¸¬åˆ°ç•°å¸¸æˆ–æŒ‰ä¸‹ Web æ–·é›»éˆ•æ™‚ï¼Œå¼·åˆ¶åˆ‡æ–·å¼·é›»ã€‚
*   **æ¥æ³•**ï¼šESP32 æ§åˆ¶çš„ç¹¼é›»å™¨ (GPIO 39) çš„ **NC (å¸¸é–‰) æ¥é»**ï¼Œéœ€ **ä¸²è¯ (Series)** åœ¨æ¥è§¸å™¨çš„ç·šåœˆä¾›é›»è¿´è·¯ä¸Šã€‚
*   **å‹•ä½œ**ï¼šESP32 é€å‡ºè¨Šè™Ÿ -> ç¹¼é›»å™¨æ–·é–‹ -> æ¥è§¸å™¨ç·šåœˆå¤±é›» -> ç³»çµ±è·³è„«ã€‚

### 3. ç‹€æ…‹å›é¥‹ (Feedback)
*   **é‡è¦**ï¼šå› ç‚º ESP32 æ˜¯ 3.3V é‚è¼¯ï¼Œ**çµ•å°ä¸å¯**ç›´æ¥å°‡æ¥è§¸å™¨çš„ 24V/110V è¼”åŠ©æ¥é»æ¥åˆ° GPIOã€‚
*   **æ¥æ³•**ï¼šä½¿ç”¨ **å…‰è€¦åˆéš”é›¢æ¨¡çµ„ (Optocoupler)** æˆ– **24Vè½‰3.3V æ¨¡çµ„**ã€‚

---

## ğŸŒ ç¶²è·¯é…ç½®èˆ‡æ•‘æ´æ¨¡å¼ (Network & Rescue)

æœ¬ç³»çµ±å…·å‚™æ™ºæ…§é…ç¶²åŠŸèƒ½ï¼Œç„¡éœ€æ¯æ¬¡ä¿®æ”¹ç¨‹å¼ç¢¼ã€‚

### 1. æ­£å¸¸å•Ÿå‹•
*   ç³»çµ±æœƒè®€å–å…§éƒ¨è¨˜æ†¶é«” (NVS) çš„ WiFi è¨­å®šã€‚
*   é è¨­å‡ºå» è¨­å®šç‚ºï¼š
    *   SSID: `SSID`
    *   å¯†ç¢¼: `********`
    *   Static IP: `192.168.2.124`

### 2. æ•‘æ´æ¨¡å¼ (AP Mode)
è‹¥ ESP32 é€£æ¥ WiFi å¤±æ•— (è¶…é 5 æ¬¡é‡è©¦)ï¼Œå°‡è‡ªå‹•åˆ‡æ›ç‚º **ç†±é»æ¨¡å¼**ï¼š
1.  **æœå°‹ WiFi**: `ESP32-Rescue-Mode`
2.  **é€£æ¥å¯†ç¢¼**: ç„¡ (æˆ–è‡ªè¨‚)
3.  **ç€è¦½å™¨è¨ªå•**: `http://192.168.4.1`
4.  åœ¨å„€è¡¨æ¿çš„ã€Œç¶²è·¯è¨­å®šã€å€å¡Šè¼¸å…¥æ­£ç¢ºçš„ WiFi è³‡è¨Šï¼Œé»æ“Šã€Œå„²å­˜ä¸¦é‡å•Ÿã€å³å¯ã€‚

---

## ğŸ–¥ï¸ Web å„€è¡¨æ¿ (Dashboard)

ç³»çµ±å•Ÿå‹•å¾Œï¼Œè«‹è¨ªå•è¨­å®šçš„ IP (é è¨­ `http://192.168.2.124`)ã€‚

### åŠŸèƒ½å€å¡Š
1.  **Monitor (å·¦å´)**: ç›£æ§åœæ­¢æŒ‰éˆ•ã€æ¥è§¸å™¨ç‹€æ…‹ã€æ©Ÿç®±æº«åº¦ã€‚
2.  **Network Config (ä¸­é–“)**: ä¿®æ”¹ WiFi SSIDã€å¯†ç¢¼èˆ‡å›ºå®š IP (ä¿®æ”¹å¾Œè‡ªå‹•é‡å•Ÿ)ã€‚
3.  **Control (ä¸­é–“)**: é ç«¯åŸ·è¡Œå•Ÿå‹•ã€æ–·é›»ã€ä¼ºæœå§‹èƒ½åˆ‡æ›ã€‚
4.  **OTA (å³å´)**: å¡«å…¥ `.bin` é€£çµé€²è¡Œç„¡ç·šæ›´æ–°ã€‚
5.  **Motors (ä¸‹æ–¹)**: 7 è»¸é¦¬é”æ§åˆ¶ï¼Œå…·å‚™ **RUN (å–®æ¬¡åŸ·è¡Œ)** èˆ‡ **Jog (é»å‹•é•·æŒ‰)** æŒ‰éˆ•ã€‚

---

## ğŸš€ é–‹ç™¼èˆ‡ç‡’éŒ„ (Development)

æœ¬å°ˆæ¡ˆä½¿ç”¨ ESP-IDF v5.4 é–‹ç™¼ï¼Œä¸¦æ¡ç”¨ SPIFFS å­˜æ”¾ç¶²é æª”æ¡ˆã€‚

**å°ˆæ¡ˆçµæ§‹è¦æ±‚:**
å¿…é ˆåœ¨æ ¹ç›®éŒ„å»ºç«‹ `spiffs_image` è³‡æ–™å¤¾ï¼Œä¸¦å°‡ `index.html` æ”¾å…¥å…¶ä¸­ã€‚
Esp32-S3_ServoDriver/
â”œâ”€â”€ CMakeLists.txt (Root, éœ€åŒ…å« spiffs_create_partition_image)
â”œâ”€â”€ partitions.csv (éœ€å®šç¾© storage åˆ†å€)
â”œâ”€â”€ spiffs_image/
â”‚ â””â”€â”€ index.html
â””â”€â”€ main/
â”œâ”€â”€ main.c
â””â”€â”€ CMakeLists.txt (Main, ç§»é™¤ index.html å¼•ç”¨)
code
Code
**ç·¨è­¯ç’°å¢ƒè¨­å®š:**
```bash
idf.py set-target esp32s3
idf.py menuconfig
# 1. Serial Flasher -> Flash size: 16MB
# 2. Component config -> ESP32S3-Specific -> PSRAM: Octal Mode
# 3. Partition Table -> Custom partition table CSV
ç·¨è­¯èˆ‡ç‡’éŒ„:
ç”±æ–¼ä½¿ç”¨äº† SPIFFS æ‰“åŒ…ï¼Œè«‹ç¢ºä¿ CMake å·²æ­£ç¢ºé…ç½® spiffs_create_partition_imageã€‚
code
Bash
# æ¸…é™¤èˆŠçš„ç·¨è­¯æª” (å»ºè­°)
idf.py fullclean

# ç·¨è­¯ã€ç‡’éŒ„ (åŒ…å«ç¨‹å¼ç¢¼èˆ‡ç¶²é æª”)ã€é–‹å•Ÿç›£æ§
idf.py build flash monitor
âš ï¸ æ³¨æ„äº‹é …:
1.  PSRAM: å¿…é ˆé–‹å•Ÿ Octal PSRAMï¼Œå¦å‰‡ N16R8 æ¨¡çµ„å°‡ç„¡æ³•æ­£å¸¸é‹ä½œã€‚
2.  Partition Table: å¿…é ˆé ç•™è¶³å¤ ç©ºé–“çµ¦ storage åˆ†å€ä»¥å­˜æ”¾ç¶²é ã€‚